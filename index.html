<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ëª©ì°¨ ë„êµ¬ í†µí•© í˜ì´ì§€</title>
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 15px;
            line-height: 1.5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 25px 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 8px;
            font-weight: 700;
            letter-spacing: -0.02em;
        }

        .header p {
            opacity: 0.9;
            font-size: 1em;
            font-weight: 400;
        }

        .tab-navigation {
            display: flex;
            background: #f8fafc;
            border-bottom: 2px solid #e2e8f0;
        }

        .tab-button {
            flex: 1;
            background: none;
            border: none;
            padding: 16px 25px;
            font-size: 1em;
            font-weight: 600;
            color: #64748b;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .tab-button:hover {
            background: #f1f5f9;
            color: #334155;
        }

        .tab-button.active {
            color: #2c3e50;
            background: white;
            border-bottom-color: #667eea;
        }

        .tab-content {
            display: none;
            padding: 25px 30px;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ì…ë ¥ ì„¹ì…˜ ì»´íŒ©íŠ¸í™” */
        .color-page-generator .input-section {
            background: #f8fafc;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid #e2e8f0;
        }

        .color-page-generator .input-row {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            gap: 20px;
            align-items: start;
        }

        .color-page-generator .input-group {
            margin-bottom: 20px;
        }

        .color-page-generator .input-group:last-child {
            margin-bottom: 0;
        }

        .color-page-generator .input-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #1e293b;
            font-size: 0.95em;
            letter-spacing: -0.01em;
        }

        .color-page-generator .input-group textarea {
            width: 100%;
            min-height: 140px;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-family: 'Pretendard', monospace;
            font-size: 14px;
            line-height: 1.6;
            resize: vertical;
            transition: all 0.3s ease;
            background: white;
        }

        .color-page-generator .input-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .color-page-generator .input-group input[type="number"],
        .color-page-generator .input-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            background: white;
        }

        .color-page-generator .input-group input[type="number"]:focus,
        .color-page-generator .input-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .color-page-generator .button-group {
            text-align: center;
            margin-top: 20px;
        }

        .color-page-generator .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 14px 32px;
            border: none;
            border-radius: 40px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.3);
            letter-spacing: -0.01em;
        }

        .color-page-generator .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4);
        }

        /* ê²°ê³¼ ì„¹ì…˜ ëŒ€í­ ê°œì„  */
        .color-page-generator .results-section {
            background: #ffffff;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            margin-top: 25px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }

        .color-page-generator .results-header {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 18px 25px;
            font-weight: 700;
            font-size: 1.1em;
            letter-spacing: -0.01em;
        }

        .color-page-generator .results-content {
            padding: 20px 25px;
        }

        /* í•µì‹¬ ì •ë³´ ì¹´ë“œí˜• ë ˆì´ì•„ì›ƒ */
        .color-page-generator .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .color-page-generator .summary-card {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.2);
            position: relative;
            overflow: hidden;
        }

        .color-page-generator .summary-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 60px;
            height: 60px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            transform: translate(20px, -20px);
        }

        .color-page-generator .summary-card h3 {
            font-size: 1.1em;
            margin-bottom: 12px;
            font-weight: 700;
        }

        .color-page-generator .summary-card .page-numbers {
            font-size: 1.2em;
            font-weight: 700;
            margin-bottom: 8px;
            font-family: 'Pretendard', monospace;
            word-break: break-all;
            line-height: 1.4;
        }

        .color-page-generator .summary-card .page-count {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 15px;
        }

        .color-page-generator .copy-btn-card {
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85em;
            backdrop-filter: blur(10px);
        }

        .color-page-generator .copy-btn-card:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-1px);
        }

        .color-page-generator .all-summary-card {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.2);
        }

        .color-page-generator .all-summary-card h3 {
            font-size: 1.2em;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .color-page-generator .all-summary-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .color-page-generator .summary-stat {
            background: rgba(255,255,255,0.1);
            padding: 12px 15px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }

        .color-page-generator .summary-stat strong {
            display: block;
            font-size: 0.85em;
            margin-bottom: 4px;
            opacity: 0.9;
        }

        .color-page-generator .summary-stat span {
            font-size: 1.1em;
            font-weight: 700;
        }

        .color-page-generator .all-separators {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            backdrop-filter: blur(10px);
        }

        .color-page-generator .separator-line {
            margin-bottom: 8px;
            font-size: 0.95em;
            font-weight: 600;
        }

        .color-page-generator .separator-line:last-child {
            margin-bottom: 0;
        }

        .color-page-generator .copy-all-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
            backdrop-filter: blur(10px);
            width: 100%;
        }

        .color-page-generator .copy-all-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-1px);
        }

        /* ìƒì„¸ ê²°ê³¼ ì»´íŒ©íŠ¸í™” */
        .color-page-generator .collapsible-section {
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            margin-top: 20px;
            overflow: hidden;
            background: white;
        }

        .color-page-generator .collapsible-header {
            background: linear-gradient(135deg, #64748b 0%, #475569 100%);
            color: white;
            padding: 15px 25px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
            font-size: 1em;
            transition: background 0.3s ease;
        }

        .color-page-generator .collapsible-header:hover {
            background: linear-gradient(135deg, #475569 0%, #334155 100%);
        }

        .color-page-generator .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .color-page-generator .collapsible-content.expanded {
            max-height: 1500px;
        }

        .color-page-generator .collapsible-arrow {
            transition: transform 0.3s ease;
        }

        .color-page-generator .collapsible-arrow.rotated {
            transform: rotate(180deg);
        }

        .color-page-generator .detail-tabs {
            display: flex;
            background: #f8fafc;
            border-bottom: 2px solid #e2e8f0;
            overflow-x: auto;
            flex-wrap: nowrap;
        }

        .color-page-generator .detail-tabs::-webkit-scrollbar {
            height: 3px;
        }

        .color-page-generator .detail-tabs::-webkit-scrollbar-track {
            background: #f1f5f9;
        }

        .color-page-generator .detail-tabs::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 2px;
        }

        .color-page-generator .detail-tab {
            background: none;
            border: none;
            padding: 12px 20px;
            font-size: 0.9em;
            font-weight: 600;
            color: #64748b;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
            min-width: 100px;
        }

        .color-page-generator .detail-tab:hover {
            background: #f1f5f9;
            color: #334155;
        }

        .color-page-generator .detail-tab.active {
            color: #667eea;
            background: white;
            border-bottom-color: #667eea;
        }

        .color-page-generator .detail-tab-content {
            display: none;
            padding: 20px;
            max-height: 1200px;
            overflow-y: auto;
        }

        .color-page-generator .detail-tab-content::-webkit-scrollbar {
            width: 6px;
        }

        .color-page-generator .detail-tab-content::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 3px;
        }

        .color-page-generator .detail-tab-content::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }

        .color-page-generator .detail-tab-content::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        .color-page-generator .detail-tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease-in;
        }

        .color-page-generator .result-item {
            background: #f8fafc;
            border-left: 4px solid #667eea;
            padding: 15px 20px;
            margin-bottom: 12px;
            border-radius: 0 8px 8px 0;
            box-shadow: 0 2px 6px rgba(0,0,0,0.04);
            transition: all 0.2s ease;
        }

        .color-page-generator .result-item:hover {
            transform: translateX(3px);
            box-shadow: 0 3px 12px rgba(0,0,0,0.08);
        }

        .color-page-generator .result-item h3 {
            color: #1e293b;
            margin-bottom: 8px;
            font-size: 1em;
            font-weight: 600;
            letter-spacing: -0.01em;
        }

        .color-page-generator .page-info {
            font-family: 'Pretendard', monospace;
            background: #e2e8f0;
            padding: 10px 15px;
            border-radius: 6px;
            margin-top: 8px;
            font-weight: 600;
            color: #475569;
            line-height: 1.4;
            font-size: 0.85em;
        }

        .color-page-generator .example {
            background: #eff6ff;
            border: 1px solid #bfdbfe;
            border-radius: 8px;
            padding: 15px;
            margin-top: 12px;
            font-size: 13px;
            color: #1e40af;
        }

        .color-page-generator .example-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #1e40af;
            font-size: 14px;
        }

        .color-page-generator .subtitle {
            color: #64748b;
            font-style: italic;
            margin: 6px 0;
            font-size: 0.9em;
            padding-left: 4px;
        }

        .color-page-generator .hidden {
            display: none;
        }

        /* ëª©ì°¨ ë¶„ì„ê¸° ìŠ¤íƒ€ì¼ ìœ ì§€ */
        .toc-analyzer .input-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .toc-analyzer .input-box {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            border: 1px solid #e9ecef;
        }

        .toc-analyzer .input-box:focus-within {
            border-color: #2c3e50;
        }

        .toc-analyzer .input-title {
            font-size: 1em;
            font-weight: 600;
            margin-bottom: 10px;
            color: #495057;
        }

        .toc-analyzer .textarea {
            width: 100%;
            height: 180px;
            padding: 12px;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            font-family: 'Pretendard', monospace;
            font-size: 13px;
            line-height: 1.5;
            resize: vertical;
            outline: none;
        }

        .toc-analyzer .textarea:focus {
            border-color: #2c3e50;
            box-shadow: 0 0 0 2px rgba(44, 62, 80, 0.1);
        }

        .toc-analyzer .count {
            margin-top: 8px;
            font-size: 0.8em;
            color: #6c757d;
            font-weight: 500;
        }

        .toc-analyzer .compare-section {
            text-align: center;
            margin-bottom: 25px;
        }

        .toc-analyzer .compare-btn {
            background: #2c3e50;
            color: white;
            border: none;
            padding: 14px 35px;
            border-radius: 6px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .toc-analyzer .compare-btn:hover {
            background: #34495e;
        }

        .toc-analyzer .compare-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }

        .toc-analyzer .results {
            display: none;
        }

        .toc-analyzer .results.show {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }

        .toc-analyzer .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
            align-items: center;
            background: #f8f9fa;
            padding: 12px 20px;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }

        .toc-analyzer .filter-group {
            display: flex;
            background: white;
            border-radius: 6px;
            overflow: hidden;
            border: 1px solid #dee2e6;
        }

        .toc-analyzer .filter-btn {
            padding: 8px 16px;
            border: none;
            background: white;
            color: #6c757d;
            cursor: pointer;
            font-weight: 500;
            font-size: 0.85em;
        }

        .toc-analyzer .filter-btn.active {
            background: #2c3e50;
            color: white;
        }

        .toc-analyzer .filter-btn:hover:not(.active) {
            background: #f8f9fa;
        }

        .toc-analyzer .summary-stats {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            margin: 0 auto;
            flex: 1;
            max-width: 500px;
        }

        .toc-analyzer .stat-card {
            background: white;
            padding: 10px 12px;
            border-radius: 8px;
            text-align: center;
            border-left: 4px solid;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            transition: transform 0.3s;
            min-width: 70px;
            flex: 1;
        }

        .toc-analyzer .stat-card:hover {
            transform: translateY(-2px);
        }

        .toc-analyzer .stat-card.total { border-left-color: #007bff; }
        .toc-analyzer .stat-card.added { border-left-color: #28a745; }
        .toc-analyzer .stat-card.deleted { border-left-color: #dc3545; }
        .toc-analyzer .stat-card.modified { border-left-color: #ffc107; }
        .toc-analyzer .stat-card.urgent { border-left-color: #dc3545; background: #fff5f5; }

        .toc-analyzer .stat-number {
            font-size: 1.4em;
            font-weight: 700;
            margin-bottom: 2px;
            color: #495057;
        }

        .toc-analyzer .stat-label {
            font-size: 0.7em;
            color: #6c757d;
            font-weight: 500;
        }

        .toc-analyzer .copy-btn {
            padding: 8px 16px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 16px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            font-size: 0.85em;
        }

        .toc-analyzer .copy-btn:hover {
            background: #218838;
            transform: translateY(-1px);
        }

        .toc-analyzer .results-list {
            max-height: 65vh;
            overflow-y: auto;
            padding-right: 6px;
        }

        .toc-analyzer .results-list::-webkit-scrollbar {
            width: 5px;
        }

        .toc-analyzer .results-list::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 6px;
        }

        .toc-analyzer .results-list::-webkit-scrollbar-thumb {
            background: #4facfe;
            border-radius: 6px;
        }

        .toc-analyzer .result-row {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            border-radius: 8px;
            overflow: hidden;
            background: white;
            box-shadow: 0 2px 6px rgba(0,0,0,0.06);
            border: 1px solid #e0e0e0;
            transition: all 0.2s;
        }

        .toc-analyzer .result-row:hover {
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .toc-analyzer .status-indicator {
            width: 5px;
            height: 70px;
            min-height: 70px;
        }

        .toc-analyzer .status-indicator.added { background: #28a745; }
        .toc-analyzer .status-indicator.deleted { background: #dc3545; }
        .toc-analyzer .status-indicator.modified { background: #ffc107; }
        .toc-analyzer .status-indicator.page-changed { background: #007bff; }
        .toc-analyzer .status-indicator.unchanged { background: #6c757d; }

        .toc-analyzer .content-main {
            flex: 1;
            padding: 12px 16px;
        }

        .toc-analyzer .content-title {
            font-weight: 600;
            margin-bottom: 6px;
            color: #2c3e50;
            line-height: 1.3;
            font-size: 0.95em;
        }

        .toc-analyzer .content-subtitle {
            font-size: 0.8em;
            color: #6c757d;
            line-height: 1.3;
        }

        .toc-analyzer .content-before,
        .toc-analyzer .content-after {
            display: block;
            margin-bottom: 3px;
            padding: 3px 0;
        }

        .toc-analyzer .content-before {
            color: #dc3545;
            text-decoration: line-through;
        }

        .toc-analyzer .content-after {
            color: #28a745;
        }

        .toc-analyzer .content-single {
            color: #2c3e50;
        }

        .toc-analyzer .content-single.deleted {
            color: #dc3545;
            text-decoration: line-through;
        }

        .toc-analyzer .status-badge {
            padding: 6px 12px;
            margin-right: 12px;
            border-radius: 16px;
            font-size: 0.75em;
            font-weight: 600;
            text-align: center;
            min-width: 50px;
            color: white;
        }

        .toc-analyzer .status-badge.added { background: #28a745; }
        .toc-analyzer .status-badge.deleted { background: #dc3545; }
        .toc-analyzer .status-badge.modified { background: #ffc107; color: #1a1a1a; }
        .toc-analyzer .status-badge.page-changed { background: #007bff; }
        .toc-analyzer .status-badge.unchanged { background: #6c757d; }

        .toc-analyzer .no-results {
            text-align: center;
            padding: 50px 20px;
            color: #6c757d;
        }

        .toc-analyzer .no-results-icon {
            font-size: 2.5em;
            margin-bottom: 12px;
        }

        .toc-analyzer .no-results-title {
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 6px;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .container {
                border-radius: 12px;
            }

            .tab-content {
                padding: 20px 15px;
            }

            .tab-button {
                padding: 12px 15px;
                font-size: 0.9em;
            }

            .color-page-generator .input-row {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .color-page-generator .results-grid {
                grid-template-columns: 1fr;
            }

            .color-page-generator .all-summary-info {
                grid-template-columns: 1fr;
            }

            .toc-analyzer .input-section {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .toc-analyzer .controls {
                flex-direction: column;
                gap: 12px;
            }

            .toc-analyzer .summary-stats {
                max-width: 100%;
            }

            .toc-analyzer .stat-card {
                min-width: 60px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“š ëª©ì°¨ ë„êµ¬ ëª¨ìŒ</h1>
            <p>íš¨ìœ¨ì ì¸ ëª©ì°¨ ê´€ë¦¬ë¥¼ ìœ„í•œ ì „ë¬¸ ë„êµ¬</p>
        </div>

        <div class="tab-navigation">
            <button class="tab-button active" id="colorPageBtn">
                ğŸ“– ìƒ‰ì§€ í˜ì´ì§€ ìƒì„±ê¸°
            </button>
            <button class="tab-button" id="tocAnalyzerBtn">
                ğŸ“‹ ëª©ì°¨ ë¹„êµ ë¶„ì„ê¸°
            </button>
        </div>

        <div id="colorPageTab" class="tab-content active color-page-generator">
            <div class="input-section">
                <div class="input-row">
                    <div class="input-group">
                        <label for="tocInput">ëª©ì°¨ ë‚´ìš© ì…ë ¥</label>
                        <textarea id="tocInput" placeholder="ëª©ì°¨ë¥¼ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
                        <div class="example">
                            <div class="example-title">ì…ë ¥ í˜•ì‹ ì˜ˆì‹œ</div>
                            <div><strong>ëŒ€ì œëª©:</strong> â… . ì±•í„°ëª… Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â·Â· 1</div>
                            <div><strong>ì¤‘ì œëª©:</strong> 1. ì„¸ë¶€í•­ëª© Â·Â·Â·Â·Â·Â·Â·Â· 5</div>
                            <div><strong>ì†Œì œëª©:</strong> 1) í•˜ìœ„í•­ëª© Â·Â·Â·Â·Â·Â·Â·Â· 10</div>
                            <div style="margin-top: 8px; font-size: 12px; color: #6366f1;">
                                ğŸ’¡ ê³„ì¸µë³„ë¡œ ì„œë¡œ ë‹¤ë¥¸ ê°„ì§€ê°€ í•„ìš”í•œ ê²½ìš° í™œìš©í•˜ì„¸ìš”
                            </div>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label for="extraPages">ì¶”ê°€ í˜ì´ì§€ ìˆ˜</label>
                        <input type="number" id="extraPages" placeholder="0" min="0">
                        <div style="font-size: 12px; color: #64748b; margin-top: 6px;">
                            í‘œì§€, ì„œë¬¸ ë“± ëª©ì°¨ì— í¬í•¨ë˜ì§€ ì•ŠëŠ” í˜ì´ì§€
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label for="separatorCount">ê°„ì§€ ì¢…ë¥˜ ìˆ˜</label>
                        <select id="separatorCount">
                            <option value="1">1ì¢…</option>
                            <option value="2">2ì¢…</option>
                            <option value="3">3ì¢…</option>
                            <option value="4">4ì¢…</option>
                        </select>
                        <div style="font-size: 12px; color: #64748b; margin-top: 6px;">
                            ì„ íƒí•œ ì¢…ë¥˜ ìˆ˜ë§Œí¼ë§Œ ê°„ì§€ ìƒì„±
                        </div>
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn" id="generateBtn">ğŸš€ ìƒ‰ì§€ í˜ì´ì§€ ìƒì„±</button>
                </div>
            </div>

            <div id="results" class="results-section hidden">
                <div class="results-header">
                    ğŸ¯ ìƒì„±ëœ ìƒ‰ì§€ í˜ì´ì§€ ì •ë³´
                </div>
                <div class="results-content" id="resultsContent">
                </div>
            </div>
        </div>

        <div id="tocAnalyzerTab" class="tab-content toc-analyzer">
            <div class="input-section">
                <div class="input-box">
                    <div class="input-title">ğŸ“„ ê¸°ì¡´ ëª©ì°¨</div>
                    <textarea id="oldTOC" class="textarea" placeholder="ê¸°ì¡´ ëª©ì°¨ë¥¼ ë¶™ì—¬ë„£ì–´ì£¼ì„¸ìš”"></textarea>
                    <div class="count" id="oldCount">0ì¤„</div>
                </div>
                <div class="input-box">
                    <div class="input-title">ğŸ“ ìƒˆë¡œìš´ ëª©ì°¨</div>
                    <textarea id="newTOC" class="textarea" placeholder="ìƒˆë¡œìš´ ëª©ì°¨ë¥¼ ë¶™ì—¬ë„£ì–´ì£¼ì„¸ìš”"></textarea>
                    <div class="count" id="newCount">0ì¤„</div>
                </div>
            </div>
            <div class="compare-section">
                <button class="compare-btn" id="compareBtn">ğŸ” ëª©ì°¨ ë¹„êµ ë¶„ì„ ì‹œì‘</button>
            </div>
            <div class="results" id="analyzerResults">
                <div class="controls">
                    <div class="filter-group">
                        <button class="filter-btn active" data-filter="changes">ë³€ê²½ì‚¬í•­</button>
                        <button class="filter-btn" data-filter="all">ì „ì²´</button>
                        <button class="filter-btn" data-filter="urgent">ê¸´ê¸‰ê²€í† </button>
                    </div>
                    <div class="summary-stats">
                        <div class="stat-card total"><div class="stat-number" id="totalCount">0</div><div class="stat-label">ì´ í•­ëª©</div></div>
                        <div class="stat-card added"><div class="stat-number" id="addedCount">0</div><div class="stat-label">â• ì¶”ê°€</div></div>
                        <div class="stat-card deleted"><div class="stat-number" id="deletedCount">0</div><div class="stat-label">â– ì‚­ì œ</div></div>
                        <div class="stat-card modified"><div class="stat-number" id="modifiedCount">0</div><div class="stat-label">âœï¸ ìˆ˜ì •</div></div>
                        <div class="stat-card urgent"><div class="stat-number" id="urgentCount">0</div><div class="stat-label">ğŸš¨ ê¸´ê¸‰</div></div>
                    </div>
                    <button class="copy-btn" id="copyAnalyzerBtn">ğŸ“‹ ê²°ê³¼ ë³µì‚¬</button>
                </div>
                <div class="results-list" id="resultsList"></div>
            </div>
        </div>
    </div>

    <script>
        var analysisResults = [];
        var currentFilter = 'changes';

        document.addEventListener('DOMContentLoaded', function() {
            var colorPageBtn = document.getElementById('colorPageBtn');
            var tocAnalyzerBtn = document.getElementById('tocAnalyzerBtn');
            
            if (colorPageBtn) {
                colorPageBtn.addEventListener('click', function() {
                    switchTab('colorPage');
                });
            }
            
            if (tocAnalyzerBtn) {
                tocAnalyzerBtn.addEventListener('click', function() {
                    switchTab('tocAnalyzer');
                });
            }

            var generateBtn = document.getElementById('generateBtn');
            if (generateBtn) {
                generateBtn.addEventListener('click', generateColorPages);
            }

            var oldTOC = document.getElementById('oldTOC');
            var newTOC = document.getElementById('newTOC');
            var compareBtn = document.getElementById('compareBtn');
            var copyAnalyzerBtn = document.getElementById('copyAnalyzerBtn');
            
            if (oldTOC) {
                oldTOC.addEventListener('input', function() {
                    updateLineCount('oldTOC', 'oldCount');
                });
                updateLineCount('oldTOC', 'oldCount');
            }
            
            if (newTOC) {
                newTOC.addEventListener('input', function() {
                    updateLineCount('newTOC', 'newCount');
                });
                updateLineCount('newTOC', 'newCount');
            }
            
            if (compareBtn) {
                compareBtn.addEventListener('click', startComparison);
            }
            
            if (copyAnalyzerBtn) {
                copyAnalyzerBtn.addEventListener('click', copyAnalyzerResults);
            }

            var filterBtns = document.querySelectorAll('.toc-analyzer .filter-btn');
            filterBtns.forEach(function(btn) {
                btn.addEventListener('click', function(e) {
                    setFilter(e.target.dataset.filter);
                });
            });
        });

        function switchTab(tabName) {
            var tabButtons = document.querySelectorAll('.tab-button');
            for (var i = 0; i < tabButtons.length; i++) {
                tabButtons[i].classList.remove('active');
            }
            
            var tabContents = document.querySelectorAll('.tab-content');
            for (var i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove('active');
            }
            
            if (tabName === 'colorPage') {
                document.getElementById('colorPageBtn').classList.add('active');
                document.getElementById('colorPageTab').classList.add('active');
            } else if (tabName === 'tocAnalyzer') {
                document.getElementById('tocAnalyzerBtn').classList.add('active');
                document.getElementById('tocAnalyzerTab').classList.add('active');
            }
        }

        function generateColorPages() {
            var tocInput = document.getElementById('tocInput').value.trim();
            var extraPages = parseInt(document.getElementById('extraPages').value) || 0;
            
            if (!tocInput) {
                alert('ëª©ì°¨ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            try {
                var chapters = parseTOC(tocInput);
                var colorPagesByType = calculateColorPages(chapters, extraPages);
                displayResults(colorPagesByType, chapters, extraPages);
            } catch (error) {
                alert('ëª©ì°¨ ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        function parseTOC(tocText) {
            var lines = tocText.split('\n').filter(function(line) { return line.trim(); });
            var chapters = [];
            var currentChapter = null;

            for (var i = 0; i < lines.length; i++) {
                var line = lines[i];
                var trimmedLine = line.trim();
                
                // í˜ì´ì§€ ë²ˆí˜¸ íŒ¨í„´ì„ ë” ì •í™•í•˜ê²Œ ê°œì„ 
                var pageMatch = null;
                
                // íŒ¨í„´ 1: ì œëª© ë’¤ì— íƒ­ì´ë‚˜ ì—¬ëŸ¬ ê³µë°± í›„ ìˆ«ì (ê°€ì¥ ì¼ë°˜ì )
                pageMatch = trimmedLine.match(/^(.+?)\s{2,}(\d+)\s*$/);
                if (!pageMatch) {
                    // íŒ¨í„´ 2: ì œëª© ë’¤ì— ì ë“¤(....) í›„ ìˆ«ì
                    pageMatch = trimmedLine.match(/^(.+?)[Â·\.]{2,}\s*(\d+)\s*$/);
                }
                if (!pageMatch) {
                    // íŒ¨í„´ 3: ì œëª© ë’¤ì— í•˜ì´í”ˆë“¤(----) í›„ ìˆ«ì
                    pageMatch = trimmedLine.match(/^(.+?)[-]{2,}\s*(\d+)\s*$/);
                }
                if (!pageMatch) {
                    // íŒ¨í„´ 4: ì œëª© ë’¤ì— ë¬¼ê²°í‘œ(~~~) í›„ ìˆ«ì
                    pageMatch = trimmedLine.match(/^(.+?)[~]{2,}\s*(\d+)\s*$/);
                }
                
                // ë‹¨ë… ìˆ«ì ë¼ì¸ì€ í˜ì´ì§€ ë²ˆí˜¸ê°€ ì•„ë‹˜ (ì±•í„° ë²ˆí˜¸ì¼ ê°€ëŠ¥ì„±)
                if (trimmedLine.match(/^\d+\s*$/) && trimmedLine.length < 4) {
                    // 1, 2, 3 ê°™ì€ ë‹¨ë… ìˆ«ìëŠ” ì±•í„° ë²ˆí˜¸ë¡œ ì²˜ë¦¬
                    continue;
                }
                
                if (pageMatch) {
                    var pageNumber = parseInt(pageMatch[2]);
                    var title = pageMatch[1].trim();
                    
                    // ì œëª©ì—ì„œ ë¶ˆí•„ìš”í•œ ë¬¸ì ì œê±°
                    title = title.replace(/^[\s\d\.\-\*]+/, '').trim(); // ì•ì˜ ìˆ«ì, ì , í•˜ì´í”ˆ, ë³„í‘œ ì œê±°
                    title = title.replace(/\*\*/g, '').trim(); // ** ì œê±°
                    
                    var level = 1; // ê¸°ë³¸ê°’
                    var originalTitle = pageMatch[1].trim(); // ì›ë³¸ ì œëª© (ë ˆë²¨ íŒë‹¨ìš©)
                    
                    // ë ˆë²¨ íŒë‹¨ ë¡œì§ ê°œì„ 
                    if (/^\*\*.*\*\*/.test(originalTitle)) {
                        // **í…ìŠ¤íŠ¸** í˜•íƒœëŠ” ëŒ€ì œëª© (ë ˆë²¨ 1)
                        level = 1;
                    } else if (/^[â… â…¡â…¢â…£â…¤â…¥â…¦â…§â…¨â…©â…ªâ…«]+\./.test(originalTitle)) {
                        // ë¡œë§ˆìˆ«ìëŠ” ëŒ€ì œëª© (ë ˆë²¨ 1)
                        level = 1;
                    } else if (/^\d+\s/.test(originalTitle) && !/^\d+-\d+/.test(originalTitle)) {
                        // "1 ì œëª©" í˜•íƒœëŠ” ëŒ€ì œëª© (ë ˆë²¨ 1)
                        level = 1;
                    } else if (/^\d+\./.test(originalTitle) && !/^\d+-\d+\./.test(originalTitle)) {
                        // "1. ì œëª©" í˜•íƒœëŠ” ëŒ€ì œëª© (ë ˆë²¨ 1)
                        level = 1;
                    } else if (/^\d+-\d+\./.test(originalTitle)) {
                        // "1-1. ì œëª©" í˜•íƒœëŠ” ì¤‘ì œëª© (ë ˆë²¨ 2)
                        level = 2;
                    } else if (/^\s+\d+\./.test(originalTitle)) {
                        // ë“¤ì—¬ì“°ê¸°ëœ "  1. ì œëª©" í˜•íƒœëŠ” ì¤‘ì œëª© (ë ˆë²¨ 2)
                        level = 2;
                    } else if (/^\d+\)/.test(originalTitle)) {
                        // "1)" í˜•íƒœëŠ” ì†Œì œëª© (ë ˆë²¨ 3)
                        level = 3;
                    } else if (/^\(\d+\)/.test(originalTitle)) {
                        // "(1)" í˜•íƒœëŠ” ì†Œì œëª© (ë ˆë²¨ 3)
                        level = 3;
                    } else if (/^\([ê°€-í£]+\)/.test(originalTitle)) {
                        // "(ê°€), (ë‚˜)" í˜•íƒœëŠ” ì„¸ë¶€ì œëª© (ë ˆë²¨ 4)
                        level = 4;
                    } else if (/^\(\s*ì°¸ê³ \s*\)/.test(originalTitle)) {
                        // "(ì°¸ê³ )" í˜•íƒœëŠ” ì¤‘ì œëª© (ë ˆë²¨ 2)
                        level = 2;
                    } else {
                        // ë“¤ì—¬ì“°ê¸°ë¡œ ë ˆë²¨ íŒë‹¨
                        var indentLevel = (line.length - line.trimLeft().length);
                        if (indentLevel >= 4) {
                            level = 2; // ë“¤ì—¬ì“°ê¸°ê°€ ìˆìœ¼ë©´ ì¤‘ì œëª©
                        } else {
                            level = 1; // ê¸°ë³¸ì€ ëŒ€ì œëª©
                        }
                    }
                    
                    var chapterNumber = chapters.length + 1;
                    
                    currentChapter = {
                        number: chapterNumber,
                        title: title,
                        page: pageNumber,
                        level: level,
                        subtitles: [],
                        originalLine: line // ë””ë²„ê¹…ìš©
                    };
                    chapters.push(currentChapter);
                } else if (trimmedLine.startsWith('-') && currentChapter) {
                    var subtitle = trimmedLine.substring(1).trim();
                    currentChapter.subtitles.push(subtitle);
                }
            }

            if (chapters.length === 0) {
                throw new Error('í˜ì´ì§€ ë²ˆí˜¸ê°€ í¬í•¨ëœ ëª©ì°¨ í•­ëª©ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }

            return chapters;
        }

        function calculateColorPages(chapters, extraPages) {
            var separatorCount = parseInt(document.getElementById('separatorCount').value) || 1;
            var colorPagesByType = {};
            
            for (var type = 1; type <= separatorCount; type++) {
                colorPagesByType['ê°„ì§€' + type] = [];
            }

            for (var i = 0; i < chapters.length; i++) {
                var chapter = chapters[i];
                
                if (chapter.level <= separatorCount) {
                    var tocColorPage = chapter.page;
                    var actualColorPage = tocColorPage + extraPages;
                    
                    var separatorType = 'ê°„ì§€' + chapter.level;
                    
                    colorPagesByType[separatorType].push({
                        colorPage: actualColorPage,
                        chapterTitle: chapter.title,
                        chapterNumber: chapter.number,
                        tocColorPage: tocColorPage,
                        subtitles: chapter.subtitles,
                        level: chapter.level
                    });
                }
            }

            return colorPagesByType;
        }

        function displayResults(colorPagesByType, chapters, extraPages) {
            var resultsContent = document.getElementById('resultsContent');
            var results = document.getElementById('results');
            
            var html = '';
            var allSeparatorData = [];
            
            // ì¹´ë“œí˜• ê°„ì§€ë³„ ìš”ì•½ ìƒì„±
            html += '<div class="results-grid">';
            for (var separatorType in colorPagesByType) {
                var items = colorPagesByType[separatorType];
                if (items.length > 0) {
                    var pageNumbers = items.map(function(item) { return item.colorPage; }).sort(function(a, b) { return a - b; });
                    
                    // ì „ì²´ ìš”ì•½ìš© ë°ì´í„° ì €ì¥
                    allSeparatorData.push({
                        type: separatorType,
                        pages: pageNumbers,
                        count: pageNumbers.length
                    });
                    
                    html += '<div class="summary-card">';
                    html += '<h3>ğŸ“‹ ' + separatorType + '</h3>';
                    html += '<div class="page-numbers" id="colorPageResult' + separatorType + '">' + pageNumbers.join(', ') + '</div>';
                    html += '<div class="page-count">ì´ ' + pageNumbers.length + 'í˜ì´ì§€</div>';
                    html += '<button class="copy-btn-card copy-specific-btn" data-type="' + separatorType + '">ğŸ“‹ ë³µì‚¬</button>';
                    html += '</div>';
                }
            }
            html += '</div>';
            
            // ì „ì²´ ìš”ì•½ ì¹´ë“œ
            html += '<div class="all-summary-card">';
            html += '<h3>ğŸ“Š ì „ì²´ ìš”ì•½</h3>';
            html += '<div class="all-summary-info">';
            html += '<div class="summary-stat"><strong>ì „ì²´ ì±•í„°</strong><span>' + chapters.length + 'ê°œ</span></div>';
            html += '<div class="summary-stat"><strong>ì¶”ê°€ í˜ì´ì§€</strong><span>' + extraPages + 'í˜ì´ì§€</span></div>';
            html += '</div>';
            
            html += '<div class="all-separators">';
            for (var i = 0; i < allSeparatorData.length; i++) {
                var data = allSeparatorData[i];
                html += '<div class="separator-line" id="allResult' + data.type + '">';
                html += '<strong>' + data.type + ' ê°„ì§€í˜ì´ì§€(PDF):</strong> ' + data.pages.join(', ') + ' (ì´ ' + data.count + 'í˜ì´ì§€)';
                html += '</div>';
            }
            html += '</div>';
            
            html += '<button class="copy-all-btn" id="copyAllSeparatorsBtn">ğŸ“‹ ì „ì²´ ê°„ì§€ ê²°ê³¼ ë³µì‚¬</button>';
            html += '</div>';

            // ì ‘ê¸°/í¼ì¹˜ê¸° ìƒì„¸ ê²°ê³¼
            html += '<div class="collapsible-section">';
            html += '<div class="collapsible-header" id="detailToggle">';
            html += '<span>ğŸ“‹ ìƒì„¸ ê²°ê³¼</span>';
            html += '<span class="collapsible-arrow">â–¼</span>';
            html += '</div>';
            html += '<div class="collapsible-content" id="detailContent">';
            
            // íƒ­ ë„¤ë¹„ê²Œì´ì…˜
            html += '<div class="detail-tabs">';
            var isFirst = true;
            for (var separatorType in colorPagesByType) {
                var items = colorPagesByType[separatorType];
                if (items.length > 0) {
                    html += '<button class="detail-tab' + (isFirst ? ' active' : '') + '" data-tab="' + separatorType + '">' + separatorType + '</button>';
                    isFirst = false;
                }
            }
            html += '</div>';

            // íƒ­ ì½˜í…ì¸ 
            isFirst = true;
            for (var separatorType in colorPagesByType) {
                var items = colorPagesByType[separatorType];
                if (items.length > 0) {
                    html += '<div class="detail-tab-content' + (isFirst ? ' active' : '') + '" id="tab-' + separatorType + '">';
                    
                    for (var j = 0; j < items.length; j++) {
                        var item = items[j];
                        html += '<div class="result-item">';
                        html += '<h3>' + item.chapterTitle + '</h3>';
                        if (item.subtitles.length > 0) {
                            html += '<div class="subtitle">â”” ' + item.subtitles.join(', ') + '</div>';
                        }
                        html += '<div class="page-info">';
                        html += 'ëª©ì°¨ ê¸°ì¤€: ' + item.tocColorPage + 'p â†’ ì‹¤ì œ PDF: ' + item.colorPage + 'p';
                        html += '</div>';
                        html += '</div>';
                    }
                    
                    html += '</div>';
                    isFirst = false;
                }
            }
            
            html += '</div>'; // collapsible-content ë‹«ê¸°
            html += '</div>'; // collapsible-section ë‹«ê¸°

            resultsContent.innerHTML = html;
            results.classList.remove('hidden');
            
            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
            setupResultsEventListeners(allSeparatorData);
            
            setTimeout(function() {
                results.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);
        }

        function setupResultsEventListeners(allSeparatorData) {
            // ì ‘ê¸°/í¼ì¹˜ê¸° ì´ë²¤íŠ¸
            var detailToggle = document.getElementById('detailToggle');
            var detailContent = document.getElementById('detailContent');
            var arrow = detailToggle.querySelector('.collapsible-arrow');
            
            detailToggle.addEventListener('click', function() {
                if (detailContent.classList.contains('expanded')) {
                    detailContent.classList.remove('expanded');
                    arrow.classList.remove('rotated');
                } else {
                    detailContent.classList.add('expanded');
                    arrow.classList.add('rotated');
                }
            });
            
            // íƒ­ ì „í™˜ ì´ë²¤íŠ¸
            var detailTabs = document.querySelectorAll('.detail-tab');
            for (var i = 0; i < detailTabs.length; i++) {
                detailTabs[i].addEventListener('click', function(e) {
                    var tabName = e.target.getAttribute('data-tab');
                    switchDetailTab(tabName);
                });
            }
            
            // ê°œë³„ ë³µì‚¬ ë²„íŠ¼ ì´ë²¤íŠ¸
            var copySpecificBtns = document.querySelectorAll('.copy-specific-btn');
            for (var i = 0; i < copySpecificBtns.length; i++) {
                copySpecificBtns[i].addEventListener('click', function(e) {
                    var separatorType = e.target.getAttribute('data-type');
                    copySpecificResult(separatorType, e.target);
                });
            }
            
            // ì „ì²´ ë³µì‚¬ ë²„íŠ¼ ì´ë²¤íŠ¸
            var copyAllBtn = document.getElementById('copyAllSeparatorsBtn');
            if (copyAllBtn) {
                copyAllBtn.addEventListener('click', function(e) {
                    copyAllSeparatorsResult(allSeparatorData, e.target);
                });
            }
        }

        function switchDetailTab(tabName) {
            // ëª¨ë“  íƒ­ ë¹„í™œì„±í™”
            var tabs = document.querySelectorAll('.detail-tab');
            for (var i = 0; i < tabs.length; i++) {
                tabs[i].classList.remove('active');
            }
            
            // ëª¨ë“  íƒ­ ì½˜í…ì¸  ìˆ¨ê¸°ê¸°
            var contents = document.querySelectorAll('.detail-tab-content');
            for (var i = 0; i < contents.length; i++) {
                contents[i].classList.remove('active');
            }
            
            // ì„ íƒëœ íƒ­ í™œì„±í™”
            var selectedTab = document.querySelector('[data-tab="' + tabName + '"]');
            var selectedContent = document.getElementById('tab-' + tabName);
            
            if (selectedTab && selectedContent) {
                selectedTab.classList.add('active');
                selectedContent.classList.add('active');
            }
        }

        function copySpecificResult(separatorType, button) {
            var resultElement = document.getElementById('colorPageResult' + separatorType);
            if (!resultElement) {
                alert('ë³µì‚¬í•  ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            var pageNumbers = resultElement.textContent.trim();
            var copyText = separatorType + ' ê°„ì§€í˜ì´ì§€(PDF): ' + pageNumbers + ' (ì´ ' + pageNumbers.split(', ').length + 'í˜ì´ì§€)';
            
            copyToClipboard(copyText, button);
        }

        function copyAllSeparatorsResult(allSeparatorData, button) {
            var copyText = '';
            for (var i = 0; i < allSeparatorData.length; i++) {
                var data = allSeparatorData[i];
                copyText += data.type + ' ê°„ì§€í˜ì´ì§€(PDF): ' + data.pages.join(', ') + ' (ì´ ' + data.count + 'í˜ì´ì§€)';
                if (i < allSeparatorData.length - 1) {
                    copyText += '\n';
                }
            }
            
            copyToClipboard(copyText, button);
        }

        function copyToClipboard(text, button) {
            if (navigator.clipboard) {
                navigator.clipboard.writeText(text).then(function() {
                    var originalText = button.textContent;
                    var originalBg = button.style.background;
                    button.textContent = 'âœ… ë³µì‚¬ì™„ë£Œ!';
                    button.style.background = 'rgba(40, 167, 69, 0.9)';
                    
                    setTimeout(function() {
                        button.textContent = originalText;
                        button.style.background = originalBg;
                    }, 1500);
                }).catch(function() {
                    fallbackCopy(text);
                });
            } else {
                fallbackCopy(text);
            }
        }

        function fallbackCopy(text) {
            var textArea = document.createElement('textarea');
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            alert('ê²°ê³¼ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        function updateLineCount(textareaId, countId) {
            var textarea = document.getElementById(textareaId);
            var countElement = document.getElementById(countId);
            if (textarea && countElement) {
                var lines = textarea.value.split('\n').filter(function(line) { return line.trim().length > 0; });
                countElement.textContent = lines.length + 'ì¤„';
            }
        }

        function parseTOCForAnalysis(text) {
            if (!text.trim()) return [];
            var lines = text.split('\n')
                .map(function(line) { return line.trim(); })
                .filter(function(line) { return line.length > 0; });
            
            return lines.map(function(line, index) {
                var trimmed = line.trim();
                var patterns = [/^(.+?)\s*[\.]{2,}\s*(\d+)$/, /^(.+?)\s{3,}(\d+)$/, /^(.+?)\s*[-~]\s*(\d+)$/];
                var title = '', page = '';
                for (var i = 0; i < patterns.length; i++) {
                    var match = trimmed.match(patterns[i]);
                    if (match) { 
                        title = match[1].trim(); 
                        page = match[2]; 
                        break; 
                    }
                }
                if (!title) title = trimmed;
                title = title.replace(/^[\d\.\-\s]*/, '').trim().replace(/[\.]{2,}$/, '').trim();
                return { index: index, title: title, page: page, original: trimmed };
            });
        }

        function calculateSimilarity(str1, str2) {
            if (str1 === str2) return 1.0;
            var longer = str1.length > str2.length ? str1 : str2;
            var shorter = str1.length > str2.length ? str2 : str1;
            if (longer.length === 0) return 1.0;
            var distance = levenshteinDistance(longer, shorter);
            return (longer.length - distance) / longer.length;
        }

        function levenshteinDistance(str1, str2) {
            var matrix = [];
            for (var i = 0; i <= str2.length; i++) {
                matrix[i] = [];
                for (var j = 0; j <= str1.length; j++) {
                    matrix[i][j] = 0;
                }
            }
            
            for (var i = 0; i <= str1.length; i++) matrix[0][i] = i;
            for (var j = 0; j <= str2.length; j++) matrix[j][0] = j;
            
            for (var j = 1; j <= str2.length; j++) {
                for (var i = 1; i <= str1.length; i++) {
                    if (str1[i - 1] === str2[j - 1]) {
                        matrix[j][i] = matrix[j - 1][i - 1];
                    } else {
                        matrix[j][i] = Math.min(
                            matrix[j - 1][i - 1] + 1,
                            matrix[j][i - 1] + 1,
                            matrix[j - 1][i] + 1
                        );
                    }
                }
            }
            return matrix[str2.length][str1.length];
        }

        function compareItems(oldItems, newItems) {
            var results = [];
            var usedOld = [];
            var usedNew = [];
            
            for (var oldIndex = 0; oldIndex < oldItems.length; oldIndex++) {
                if (oldIndex < newItems.length) {
                    var oldItem = oldItems[oldIndex];
                    var newItem = newItems[oldIndex];
                    if (oldItem.title === newItem.title) {
                        usedOld[oldIndex] = true;
                        usedNew[oldIndex] = true;
                        var changes = [];
                        if (oldItem.page !== newItem.page && oldItem.page && newItem.page) {
                            changes.push('í˜ì´ì§€ ' + oldItem.page + ' â†’ ' + newItem.page);
                        }
                        results.push({ 
                            type: changes.length > 0 ? 'page-changed' : 'unchanged', 
                            oldItem: oldItem, 
                            newItem: newItem, 
                            changes: changes, 
                            severity: 'low', 
                            position: oldIndex 
                        });
                    }
                }
            }
            
            for (var oldIndex = 0; oldIndex < oldItems.length; oldIndex++) {
                if (usedOld[oldIndex]) continue;
                
                var bestMatch = null;
                var bestSimilarity = 0;
                var bestNewIndex = -1;
                
                for (var newIndex = 0; newIndex < newItems.length; newIndex++) {
                    if (usedNew[newIndex]) continue;
                    
                    var similarity = calculateSimilarity(
                        oldItems[oldIndex].title.toLowerCase(), 
                        newItems[newIndex].title.toLowerCase()
                    );
                    
                    if (similarity > bestSimilarity && similarity > 0.7) {
                        bestMatch = newItems[newIndex];
                        bestSimilarity = similarity;
                        bestNewIndex = newIndex;
                    }
                }
                
                if (bestMatch) {
                    usedOld[oldIndex] = true;
                    usedNew[bestNewIndex] = true;
                    var changes = ['ë‚´ìš© ìˆ˜ì •'];
                    results.push({ 
                        type: 'modified', 
                        oldItem: oldItems[oldIndex], 
                        newItem: bestMatch, 
                        changes: changes, 
                        severity: 'medium', 
                        position: Math.min(oldIndex, bestNewIndex) 
                    });
                }
            }
            
            for (var oldIndex = 0; oldIndex < oldItems.length; oldIndex++) {
                if (!usedOld[oldIndex]) {
                    results.push({ 
                        type: 'deleted', 
                        oldItem: oldItems[oldIndex], 
                        newItem: null, 
                        changes: ['ì‚­ì œë¨'], 
                        severity: 'high', 
                        position: oldIndex 
                    });
                }
            }
            
            for (var newIndex = 0; newIndex < newItems.length; newIndex++) {
                if (!usedNew[newIndex]) {
                    results.push({ 
                        type: 'added', 
                        oldItem: null, 
                        newItem: newItems[newIndex], 
                        changes: ['ìƒˆë¡œ ì¶”ê°€ë¨'], 
                        severity: 'medium', 
                        position: newIndex 
                    });
                }
            }
            
            return results.sort(function(a, b) { return a.position - b.position; });
        }

        function startComparison() {
            var oldTOC = document.getElementById('oldTOC');
            var newTOC = document.getElementById('newTOC');
            var compareBtn = document.getElementById('compareBtn');
            
            var oldText = oldTOC.value;
            var newText = newTOC.value;
            
            if (!oldText.trim() || !newText.trim()) { 
                alert('ê¸°ì¡´ ëª©ì°¨ì™€ ìƒˆë¡œìš´ ëª©ì°¨ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.'); 
                return; 
            }
            
            compareBtn.disabled = true;
            compareBtn.textContent = 'ğŸ”„ ë¶„ì„ì¤‘...';
            
            setTimeout(function() {
                try {
                    var oldItems = parseTOCForAnalysis(oldText);
                    var newItems = parseTOCForAnalysis(newText);
                    analysisResults = compareItems(oldItems, newItems);
                    displayAnalysisResults();
                } catch (error) {
                    alert('ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                } finally {
                    compareBtn.disabled = false;
                    compareBtn.textContent = 'ğŸ” ëª©ì°¨ ë¹„êµ ë¶„ì„ ì‹œì‘';
                }
            }, 500);
        }

        function displayAnalysisResults() {
            var resultsDiv = document.getElementById('analyzerResults');
            resultsDiv.classList.add('show');
            
            var stats = {
                total: analysisResults.length,
                added: 0,
                deleted: 0,
                modified: 0,
                urgent: 0
            };
            
            for (var i = 0; i < analysisResults.length; i++) {
                var result = analysisResults[i];
                if (result.type === 'added') stats.added++;
                if (result.type === 'deleted') stats.deleted++;
                if (result.type === 'modified' || result.type === 'page-changed') stats.modified++;
                if (result.severity === 'high') stats.urgent++;
            }
            
            document.getElementById('totalCount').textContent = stats.total;
            document.getElementById('addedCount').textContent = stats.added;
            document.getElementById('deletedCount').textContent = stats.deleted;
            document.getElementById('modifiedCount').textContent = stats.modified;
            document.getElementById('urgentCount').textContent = stats.urgent;
            
            updateResultsList();
        }

        function setFilter(filter) {
            currentFilter = filter;
            var filterBtns = document.querySelectorAll('.toc-analyzer .filter-btn');
            for (var i = 0; i < filterBtns.length; i++) {
                filterBtns[i].classList.remove('active');
            }
            var targetBtn = document.querySelector('.toc-analyzer [data-filter="' + filter + '"]');
            if (targetBtn) {
                targetBtn.classList.add('active');
            }
            updateResultsList();
        }

        function updateResultsList() {
            var resultsListDiv = document.getElementById('resultsList');
            var filteredResults = analysisResults;
            
            if (currentFilter === 'changes') {
                filteredResults = analysisResults.filter(function(r) { return r.type !== 'unchanged'; });
            } else if (currentFilter === 'urgent') {
                filteredResults = analysisResults.filter(function(r) { return r.severity === 'high'; });
            }
            
            if (filteredResults.length === 0) {
                resultsListDiv.innerHTML = '<div class="no-results"><div class="no-results-icon">âœ…</div><div class="no-results-title">í‘œì‹œí•  í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤</div></div>';
                return;
            }
            
            var html = '';
            var typeLabels = {
                'added': 'ì¶”ê°€',
                'deleted': 'ì‚­ì œ', 
                'modified': 'ìˆ˜ì •',
                'page-changed': 'í˜ì´ì§€',
                'unchanged': 'ë™ì¼'
            };
            
            for (var i = 0; i < filteredResults.length; i++) {
                var result = filteredResults[i];
                var mainContent = '';
                var subContent = '';
                
                if (result.type === 'added') {
                    mainContent = '<span class="content-single">' + result.newItem.original + '</span>';
                    subContent = 'ìƒˆë¡œ ì¶”ê°€ëœ í•­ëª©ì…ë‹ˆë‹¤';
                } else if (result.type === 'deleted') {
                    mainContent = '<span class="content-single deleted">' + result.oldItem.original + '</span>';
                    subContent = 'ì‚­ì œëœ í•­ëª©ì…ë‹ˆë‹¤';
                } else if (result.type === 'modified' || result.type === 'page-changed') {
                    mainContent = '<span class="content-before">' + result.oldItem.original + '</span><span class="content-after">' + result.newItem.original + '</span>';
                    subContent = result.changes ? result.changes.join(' â€¢ ') : 'ë‚´ìš©ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤';
                } else {
                    mainContent = '<span class="content-single">' + result.oldItem.original + '</span>';
                    subContent = 'ë³€ê²½ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤';
                }
                
                html += '<div class="result-row">';
                html += '<div class="status-indicator ' + result.type + '"></div>';
                html += '<div class="content-main">';
                html += '<div class="content-title">' + mainContent + '</div>';
                html += '<div class="content-subtitle">' + subContent + '</div>';
                html += '</div>';
                html += '<div class="status-badge ' + result.type + '">' + typeLabels[result.type] + '</div>';
                html += '</div>';
            }
            
            resultsListDiv.innerHTML = html;
        }

        function copyAnalyzerResults() {
            if (analysisResults.length === 0) { 
                alert('ë¹„êµ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.'); 
                return; 
            }
            
            var filteredResults = analysisResults;
            var filterLabel = 'ì „ì²´';
            
            if (currentFilter === 'changes') {
                filteredResults = analysisResults.filter(function(r) { return r.type !== 'unchanged'; });
                filterLabel = 'ë³€ê²½ì‚¬í•­';
            } else if (currentFilter === 'urgent') {
                filteredResults = analysisResults.filter(function(r) { return r.severity === 'high'; });
                filterLabel = 'ê¸´ê¸‰ê²€í† ';
            }
            
            if (filteredResults.length === 0) {
                alert('í˜„ì¬ í•„í„°ì— í•´ë‹¹í•˜ëŠ” ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            var text = 'ëª©ì°¨ ë¹„êµ ë¶„ì„ ê²°ê³¼ (' + filterLabel + ')\nìƒì„±ì¼ì‹œ: ' + new Date().toLocaleString('ko-KR') + '\n\n';
            
            var typeLabels = { 
                'added': 'â• ì¶”ê°€ë¨', 
                'deleted': 'â– ì‚­ì œë¨', 
                'modified': 'âœï¸ ìˆ˜ì •ë¨', 
                'page-changed': 'ğŸ“„ í˜ì´ì§€ ë³€ê²½', 
                'unchanged': 'âœ… ë™ì¼' 
            };
            
            for (var i = 0; i < filteredResults.length; i++) {
                var result = filteredResults[i];
                text += (i + 1) + '. ' + typeLabels[result.type] + (result.severity === 'high' ? ' ğŸš¨ ê¸´ê¸‰' : '') + '\n';
                if (result.oldItem) text += '   ê¸°ì¡´: ' + result.oldItem.original + '\n';
                if (result.newItem) text += '   ìƒˆë¡œ: ' + result.newItem.original + '\n';
                if (result.changes && result.changes.length > 0) text += '   ë³€ê²½ì‚¬í•­: ' + result.changes.join(', ') + '\n';
                text += '\n';
            }
            
            text += 'â€» í¸ì§‘ì ìˆ˜ì¤€ ëª©ì°¨ ë¹„êµ ë¶„ì„ê¸°ì—ì„œ ìƒì„±ë¨';
            
            if (navigator.clipboard) {
                navigator.clipboard.writeText(text).then(function() {
                    alert(filterLabel + ' ë¶„ì„ ê²°ê³¼ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! (' + filteredResults.length + 'ê°œ í•­ëª©)');
                }).catch(function() {
                    fallbackCopy(text);
                });
            } else {
                fallbackCopy(text);
            }
        }
    </script>
</body>
</html>
